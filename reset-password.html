<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>starship - play, and explore.</title>
    <link rel="icon" href="/uploads/branding/favicon.png" type="image/x-icon" />
    <meta name="description" content="Play games, level up, and explore Starship - your new favorite gaming site." />
    <link rel="canonical" href="https://starship-app.com/" />
    <!-- Styles -->
    <link rel="stylesheet" href="/css/navbar.css" />
    <link rel="stylesheet" href="/css/main.css" />
    <link rel="stylesheet" href="/css/home.css" />
      <link rel="stylesheet" href="/css/auth.css">
    <!-- Analytics & Ads -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4851718454212779" crossorigin="anonymous"></script>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-ZZH4JE7RJF"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag('js', new Date());
      gtag('config', 'G-ZZH4JE7RJF');
    </script>
  </head>
<body>
  <!-- keep your existing navbar / sidebar — this does NOT add one -->
  <script type="module" src="/javascript/navbar.js"></script>

      <div id="profile-info" >
    <p style="font-size:36px;">Reset Password</p>
    <form id="reset-form">
      <input type="password" id="password" placeholder="New Password" required autocomplete="new-password">
      <input type="password" id="confirm" placeholder="Confirm Password" required autocomplete="new-password">
    
            <div class="username-update">
  <button type="submit" id="update-username-btn">Update Password</button>
      </div>
    </form>
    <div id="message"></div>
  </div>
  <script type="module">
    import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm';

    const supabase = createClient(
      'https://jbekjmsruiadbhaydlbt.supabase.co',
      'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpiZWtqbXNydWlhZGJoYXlkbGJ0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDgzOTQ2NTgsImV4cCI6MjA2Mzk3MDY1OH0.5Oku6Ug-UH2voQhLFGNt9a_4wJQlAHRaFwTeQRyjTSY'
    );
    window.supabase = supabase;
    window.supabaseClient = supabase;

    window.addEventListener("DOMContentLoaded", () => {
      const form = document.getElementById("reset-form");
      const message = document.getElementById("message");

      form.addEventListener("submit", async (e) => {
        e.preventDefault();

        const password = document.getElementById("password").value;
        const confirm = document.getElementById("confirm").value;

        if (password !== confirm) {
          message.textContent = "❌ Passwords do not match.";
          message.className = "text-red-500";
          return;
        }

        // Call Supabase to update password
        const { data, error } = await supabase.auth.updateUser({
          password: password,
        });

        if (error) {
          message.textContent = "⚠️ " + error.message;
          message.className = "text-red-500";
        } else {
          message.textContent = "✅ Password reset successful. Redirecting...";
          message.className = "text-green-500";
          form.reset();

          // Redirect after 2s
          setTimeout(() => {
            window.location.href = "/auth.html";
          }, 2000);
        }
      });
    });
  </script>

  <style>

    .card {
      background: rgba(255,255,255,0.05);
      border-radius: 16px;
      padding: 2rem;
      backdrop-filter: blur(12px);
      width: 100%;
      max-width: 400px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.4);
    }
    h1 {
      font-size: 1.5rem;
      margin-bottom: 1rem;
      text-align: center;
    }
    input {
      width: 100%;
      padding: 0.75rem;
      margin-bottom: 1rem;
      border-radius: 8px;
      border: none;
      outline: none;
      font-size: 1rem;
    }
    button {
      width: 100%;
      padding: 0.75rem;
      background: #4f46e5;
      border: none;
      border-radius: 8px;
      color: white;
      font-size: 1rem;
      cursor: pointer;
      transition: background 0.2s ease;
    }
    button:hover {
      background: #4338ca;
    }
    #message {
      text-align: center;
      margin-top: 1rem;
      font-weight: bold;
    }
  </style>

  <!-- preserve your other core scripts exactly -->
  <script src="/javascript/panic.js" type="module"></script>
  <script src="/javascript/cloaking.js" type="module"></script>
  <script src="/javascript/antitabclose.js" ></script>
  <script type="module" src="/javascript/notifications.js"></script>
  <script src="/javascript/screentimetracking.js" type="module"></script>
  <script src="/javascript/schedule.js"></script>
</body>
</html>
